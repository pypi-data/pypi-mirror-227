<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>intelmq.bots.experts.threshold package &#8212; intelmq 3.2.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="intelmq.bots.experts.tor_nodes package" href="intelmq.bots.experts.tor_nodes.html" />
    <link rel="prev" title="intelmq.bots.experts.taxonomy package" href="intelmq.bots.experts.taxonomy.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="intelmq-bots-experts-threshold-package">
<h1>intelmq.bots.experts.threshold package<a class="headerlink" href="#intelmq-bots-experts-threshold-package" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-intelmq.bots.experts.threshold.expert">
<span id="intelmq-bots-experts-threshold-expert-module"></span><h2>intelmq.bots.experts.threshold.expert module<a class="headerlink" href="#module-intelmq.bots.experts.threshold.expert" title="Permalink to this heading">¶</a></h2>
<p>Threshold value expert bot</p>
<p>SPDX-FileCopyrightText: 2020 Linköping University &lt;<a class="reference external" href="https://liu.se/">https://liu.se/</a>&gt;
SPDX-License-Identifier: AGPL-3.0-or-later</p>
<p>Given a stream of messages, this bot will let through only the single
one that makes the count of similar messages go above a threshold
value.</p>
<p>This bot is not multiprocessing safe. Do not run more than one
instance on the same Redis cache database.</p>
<dl class="field-list simple">
<dt class="field-odd">param redis_cache_host<span class="colon">:</span></dt>
<dd class="field-odd"><p>string</p>
</dd>
<dt class="field-even">param redis_cache_port<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">param redis_cache_db<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">param redis_cache_password<span class="colon">:</span></dt>
<dd class="field-even"><p>string.  default: {None}</p>
</dd>
<dt class="field-odd">param redis_cache_ttl<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, number of seconds to keep counts of similar
messages.</p>
</dd>
<dt class="field-even">param filter_type<span class="colon">:</span></dt>
<dd class="field-even"><p>string [“whitelist”, “blacklist”], when determining
whether two messages are similar, consider either
only the named fields, or all but the named fields
(time.observation is always ignored).</p>
</dd>
<dt class="field-odd">param bypass<span class="colon">:</span></dt>
<dd class="field-odd"><p>boolean default: False</p>
</dd>
<dt class="field-even">param filter_keys<span class="colon">:</span></dt>
<dd class="field-even"><p>list of strings, keys to exclude or include when
determining whether messages are similar.
time.observation is always ignored.</p>
</dd>
<dt class="field-odd">param threshold<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, number of messages after which one is sent on. As
long as the count is above the threshold, no new
messages will be sent.</p>
</dd>
<dt class="field-even">param add_keys<span class="colon">:</span></dt>
<dd class="field-even"><p>optional, array of strings to strings, keys to add to
forwarded messages. Regardless of this setting, the
field “extra.count” will be set to the number of
messages seen (which will be the threshold value).</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="intelmq.bots.experts.threshold.expert.BOT">
<span class="sig-prename descclassname"><span class="pre">intelmq.bots.experts.threshold.expert.</span></span><span class="sig-name descname"><span class="pre">BOT</span></span><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.BOT" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot" title="intelmq.bots.experts.threshold.expert.ThresholdExpertBot"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThresholdExpertBot</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">intelmq.bots.experts.threshold.expert.</span></span><span class="sig-name descname"><span class="pre">ThresholdExpertBot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="intelmq.lib.html#intelmq.lib.bot.ExpertBot" title="intelmq.lib.bot.ExpertBot"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpertBot</span></code></a>, <a class="reference internal" href="intelmq.lib.mixins.html#intelmq.lib.mixins.CacheMixin" title="intelmq.lib.mixins.cache.CacheMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">CacheMixin</span></code></a></p>
<p>Check if the number of similar messages during a specified time interval exceeds a set value</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.add_keys">
<span class="sig-name descname"><span class="pre">add_keys</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'comment':</span> <span class="pre">'Threshold</span> <span class="pre">reached'}</span></em><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.add_keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.bypass">
<span class="sig-name descname"><span class="pre">bypass</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.bypass" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.filter_keys">
<span class="sig-name descname"><span class="pre">filter_keys</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Iterable</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['raw',</span> <span class="pre">'time.observation']</span></em><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.filter_keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.filter_type">
<span class="sig-name descname"><span class="pre">filter_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'blacklist'</span></em><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.filter_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.init">
<span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.init" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.process">
<span class="sig-name descname"><span class="pre">process</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.process" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.redis_cache_db">
<span class="sig-name descname"><span class="pre">redis_cache_db</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">11</span></em><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.redis_cache_db" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.redis_cache_ttl">
<span class="sig-name descname"><span class="pre">redis_cache_ttl</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3600</span></em><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.redis_cache_ttl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.threshold">
<span class="sig-name descname"><span class="pre">threshold</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">100</span></em><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.threshold" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-intelmq.bots.experts.threshold">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-intelmq.bots.experts.threshold" title="Permalink to this heading">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/Logo_Intel_MQ.svg" alt="Logo"/>
    
  </a>
</p>



<p class="blurb">IntelMQ is a solution for IT security teams for collecting and processing security feeds using a message queuing protocol.</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=certtools&repo=intelmq&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/organization.html">IntelMQ Organizational Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/support.html">Getting support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/support.html#development">Development</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/hardware-requirements.html">Hardware Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/upgrade.html">Upgrade instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/configuration-management.html">Configuration and Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/bots.html">Bots inventory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/intelmqctl.html">intelmqctl documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/feeds.html">Data Feeds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/intelmq-api.html">IntelMQ API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/intelmq-manager.html">IntelMQ Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/FAQ.html">Frequently asked questions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/universe.html">IntelMQ Universe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/ELK-Stack.html">ELK Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/MISP-Integrations.html">MISP integrations in IntelMQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/n6-integrations.html">IntelMQ - n6 Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/CIFv3-Integrations.html">CIFv3 integrations in IntelMQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/eventdb.html">EventDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/abuse-contacts.html">Abuse-contact look-ups</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../dev/guide.html">Developers Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/library.html">Running IntelMQ as Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/data-format.html">Data Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/harmonization-fields.html">Harmonization field names</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/release-procedure.html">Release procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/feeds-wishlist.html">Feeds wishlist</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Code documentation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="modules.html">intelmq</a><ul>
  <li><a href="intelmq.html">intelmq package</a><ul>
  <li><a href="intelmq.bots.html">intelmq.bots package</a><ul>
  <li><a href="intelmq.bots.experts.html">intelmq.bots.experts package</a><ul>
      <li>Previous: <a href="intelmq.bots.experts.taxonomy.html" title="previous chapter">intelmq.bots.experts.taxonomy package</a></li>
      <li>Next: <a href="intelmq.bots.experts.tor_nodes.html" title="next chapter">intelmq.bots.experts.tor_nodes package</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, IntelMQ community.
      
      |
      <a href="../_sources/source/intelmq.bots.experts.threshold.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>