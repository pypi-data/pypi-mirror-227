<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Frequently asked questions &#8212; intelmq 3.2.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="IntelMQ Universe" href="universe.html" />
    <link rel="prev" title="IntelMQ Manager" href="intelmq-manager.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="frequently-asked-questions">
<h1><a class="toc-backref" href="#id2" role="doc-backlink">Frequently asked questions</a><a class="headerlink" href="#frequently-asked-questions" title="Permalink to this heading">¶</a></h1>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#frequently-asked-questions" id="id2">Frequently asked questions</a></p>
<ul>
<li><p><a class="reference internal" href="#send-intelmq-events-to-splunk" id="id3">Send IntelMQ events to Splunk</a></p></li>
<li><p><a class="reference internal" href="#permission-denied-when-using-redis-unix-socket" id="id4">Permission denied when using Redis Unix socket</a></p></li>
<li><p><a class="reference internal" href="#why-is-the-time-invalid" id="id5">Why is the time invalid?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-improve-the-speed" id="id6">How can I improve the speed?</a></p>
<ul>
<li><p><a class="reference internal" href="#multithreading" id="id7">Multithreading</a></p></li>
<li><p><a class="reference internal" href="#classic-load-balancing-multiprocessing" id="id8">“Classic” load-balancing (Multiprocessing)</a></p></li>
<li><p><a class="reference internal" href="#other-options" id="id9">Other options</a></p></li>
<li><p><a class="reference internal" href="#removing-raw-data-for-higher-performance-and-less-space-usage" id="id10">Removing raw data for higher performance and less space usage</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#my-bot-s-died-on-startup-with-no-errors-logged" id="id11">My bot(s) died on startup with no errors logged</a></p></li>
<li><p><a class="reference internal" href="#orphaned-queues" id="id12">Orphaned Queues</a></p></li>
<li><p><a class="reference internal" href="#multithreading-is-not-available-for-this-bot" id="id13">Multithreading is not available for this bot</a></p></li>
<li><p><a class="reference internal" href="#docker-security-headers" id="id14">Docker: Security Headers</a></p></li>
</ul>
</li>
</ul>
</nav>
<p>For questions about the API, have a look at the <a class="reference internal" href="intelmq-api.html"><span class="doc">API documentation page</span></a></p>
<section id="send-intelmq-events-to-splunk">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Send IntelMQ events to Splunk</a><a class="headerlink" href="#send-intelmq-events-to-splunk" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Go to Splunk and configure in order to be able to receive logs(intelmq events) to a TCP port</p></li>
<li><p>Use TCP output bot and configure accordingly to the Splunk configuration that you applied.</p></li>
</ol>
</section>
<section id="permission-denied-when-using-redis-unix-socket">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Permission denied when using Redis Unix socket</a><a class="headerlink" href="#permission-denied-when-using-redis-unix-socket" title="Permalink to this heading">¶</a></h2>
<p>If you get an error like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">intelmq</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">PipelineError</span><span class="p">:</span> <span class="n">pipeline</span> <span class="n">failed</span> <span class="o">-</span> <span class="ne">ConnectionError</span><span class="p">(</span><span class="s1">&#39;Error 13 connecting to unix socket: /var/run/redis/redis.sock. Permission denied.&#39;</span><span class="p">,)</span>
</pre></div>
</div>
<p>Make sure the intelmq user as sufficient permissions for the socket.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">/etc/redis/redis.conf</span></code> (or wherever your configuration is), check the permissions and set it for example to group-writeable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">unixsocketperm</span> <span class="mi">770</span>
</pre></div>
</div>
<p>And add the user intelmq to the redis-group:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>usermod<span class="w"> </span>-aG<span class="w"> </span>redis<span class="w"> </span>intelmq
</pre></div>
</div>
</section>
<section id="why-is-the-time-invalid">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Why is the time invalid?</a><a class="headerlink" href="#why-is-the-time-invalid" title="Permalink to this heading">¶</a></h2>
<p>If you wonder why you are getting errors like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">intelmq</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">InvalidValue</span><span class="p">:</span> <span class="n">invalid</span> <span class="n">value</span> <span class="s1">&#39;2017-03-06T07:36:29&#39;</span> <span class="p">()</span> <span class="k">for</span> <span class="n">key</span> <span class="s1">&#39;time.source&#39;</span>
</pre></div>
</div>
<p>IntelMQ requires time zone information for all timestamps. Without a time zone, the time is ambiguous and therefore rejected.</p>
</section>
<section id="how-can-i-improve-the-speed">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">How can I improve the speed?</a><a class="headerlink" href="#how-can-i-improve-the-speed" title="Permalink to this heading">¶</a></h2>
<p>In most cases the bottlenecks are look-up experts. In these cases you can easily use the integrated load balancing features.</p>
<section id="multithreading">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Multithreading</a><a class="headerlink" href="#multithreading" title="Permalink to this heading">¶</a></h3>
<p>When using the AMQP broker, you can make use of Multi-threading. See the <a class="reference internal" href="configuration-management.html#multithreading"><span class="std std-ref">Multithreading (Beta)</span></a> section.</p>
</section>
<section id="classic-load-balancing-multiprocessing">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">“Classic” load-balancing (Multiprocessing)</a><a class="headerlink" href="#classic-load-balancing-multiprocessing" title="Permalink to this heading">¶</a></h3>
<p>Before Multithreading was available in IntelMQ, and in case you use Redis as broker, the only way to do load balancing involves more work.
Create multiple instances of the same bot and connect them all to the same source and destination bots. Then set the parameter <code class="docutils literal notranslate"><span class="pre">load_balance</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code> for the bot which sends the messages to the duplicated bot. Then, the bot sends messages to only one of the destination queues and not to all of them.</p>
<p>True Multi*processing* is not available in IntelMQ. See also this <a class="reference external" href="https://github.com/certtools/intelmq/issues/186">discussion on a possible enhanced load balancing</a>.</p>
</section>
<section id="other-options">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Other options</a><a class="headerlink" href="#other-options" title="Permalink to this heading">¶</a></h3>
<p>For any bottleneck based on (online) lookups, optimize the lookup itself and if possible use local databases.</p>
<p>It is also possible to use multiple servers to spread the workload. To get the messages from one system to the other you can either directly connect to the other’s pipeline or use a fast exchange mechanism such as the TCP Collector/Output (make sure to secure the network by other means).</p>
</section>
<section id="removing-raw-data-for-higher-performance-and-less-space-usage">
<span id="faq-remove-raw-data"></span><h3><a class="toc-backref" href="#id10" role="doc-backlink">Removing raw data for higher performance and less space usage</a><a class="headerlink" href="#removing-raw-data-for-higher-performance-and-less-space-usage" title="Permalink to this heading">¶</a></h3>
<p>If you do not need the raw data, you can safely remove it. For events (after parsers), it keeps the original data, eg. a line of a CSV file. In reports it keeps the actual data to be parsed, so don’t delete the raw field in Reports - between collectors and parsers.</p>
<p>The raw data consumes about 50% - 30% of the messages’ size. The size of course depends on how many additional data you add to it and how much data the report includes. Dropping it, will improve the speed as less data needs to be transferred and processed at each step.</p>
<p><strong>In a bot</strong></p>
<p>You can do this for example by using the <em>Field Reducer Expert</em>. The configuration could be:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code>: <code class="docutils literal notranslate"><span class="pre">blacklist</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keys</span></code>: <code class="docutils literal notranslate"><span class="pre">raw</span></code></p></li>
</ul>
</div></blockquote>
<p>Other solutions are the <em>Modify</em> bot and the <em>Sieve</em> bot. The last one is a good choice if you already use it and you only need to add the command:</p>
<p><code class="docutils literal notranslate"><span class="pre">remove</span> <span class="pre">raw</span></code></p>
<p><strong>In the database</strong></p>
<p>In case you store data in the database and you want to keep its size small, you can (periodically) delete the raw data there.</p>
<p>To remove the raw data for a events table of a PostgreSQL database, you can use something like:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">events</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="ss">&quot;time.source&quot;</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="s1">&#39;2018-07-01&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>If the database is big, make sure only update small parts of the database by using an appropriate <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> clause. If you do not see any negative performance impact, you can increase the size of the chunks, otherwise the events in the output bot may queue up. The <code class="docutils literal notranslate"><span class="pre">id</span></code> column can also be used instead of the source’s time.</p>
<p>Another way of reducing the <code class="docutils literal notranslate"><span class="pre">raw</span></code>-data from the database is described in the EventDB documentation: <a class="reference internal" href="eventdb.html#eventdb-raws-table"><span class="std std-ref">Separating raw values in PostgreSQL using view and trigger</span></a></p>
</section>
</section>
<section id="my-bot-s-died-on-startup-with-no-errors-logged">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">My bot(s) died on startup with no errors logged</a><a class="headerlink" href="#my-bot-s-died-on-startup-with-no-errors-logged" title="Permalink to this heading">¶</a></h2>
<p>Rather than starting your bot(s) with <code class="docutils literal notranslate"><span class="pre">intelmqctl</span> <span class="pre">start</span></code>, try <code class="docutils literal notranslate"><span class="pre">intelmqctl</span> <span class="pre">run</span> <span class="pre">[bot]</span></code>. This will provide valuable debug output you might not otherwise see, pointing to issues like system configuration errors.</p>
</section>
<section id="orphaned-queues">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">Orphaned Queues</a><a class="headerlink" href="#orphaned-queues" title="Permalink to this heading">¶</a></h2>
<p>This section has been moved to the section <a class="reference internal" href="intelmqctl.html#orphan-queues"><span class="std std-ref">Orphaned Queues</span></a>.</p>
</section>
<section id="multithreading-is-not-available-for-this-bot">
<span id="faq-multithreading-not-avail"></span><h2><a class="toc-backref" href="#id13" role="doc-backlink">Multithreading is not available for this bot</a><a class="headerlink" href="#multithreading-is-not-available-for-this-bot" title="Permalink to this heading">¶</a></h2>
<p>Multithreading is not available for some bots and AMQP broker is necessary. Possible reasons why a certain bot or a setup does not support Multithreading include:</p>
<blockquote>
<div><ul class="simple">
<li><p>Multithreading is only available when using the AMQP broker.</p></li>
<li><p>For most collectors, Multithreading is disabled. Otherwise this would lead to duplicated data, as the data retrieval is not atomic.</p></li>
<li><p>Some bots use libraries which are not thread safe. Look a the bot’s documentation for more information.</p></li>
<li><p>Some bots’ operations are not thread safe. Look a the bot’s documentation for more information.</p></li>
</ul>
</div></blockquote>
<p>If you think this mapping is wrong, please report a bug.</p>
</section>
<section id="docker-security-headers">
<span id="id1"></span><h2><a class="toc-backref" href="#id14" role="doc-backlink">Docker: Security Headers</a><a class="headerlink" href="#docker-security-headers" title="Permalink to this heading">¶</a></h2>
<p>If you run our docker image in production, we recommend you to set security headers.
You can do this by creating a new file called <code class="docutils literal notranslate"><span class="pre">example_config/nginx/security.conf</span></code> in the cloned <code class="docutils literal notranslate"><span class="pre">intelmq-docker</span></code> repository.</p>
<p>Write the following inside the configuration file, and change the <code class="docutils literal notranslate"><span class="pre">http(s)://&lt;your-domain&gt;</span></code> to your domain name.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>server_tokens<span class="w"> </span>off<span class="p">;</span><span class="w"> </span><span class="c1"># turn off server_token, instead of nginx/13.2 now it will only show nginx</span>
add_header<span class="w"> </span>X-Frame-Options<span class="w"> </span>SAMEORIGIN<span class="p">;</span><span class="w"> </span><span class="c1"># https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options</span>
add_header<span class="w"> </span>X-Content-Type-Options<span class="w"> </span>nosniff<span class="p">;</span><span class="w"> </span><span class="c1"># https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options</span>
add_header<span class="w"> </span>X-XSS-Protection<span class="w"> </span><span class="s2">&quot;1; mode=block&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1"># https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection</span>
add_header<span class="w"> </span>Content-Security-Policy<span class="w"> </span><span class="s2">&quot;script-src &#39;self&#39; &#39;unsafe-inline&#39; http(s)://&lt;your-domain&gt;; frame-src &#39;self&#39; http(s)://&lt;your-domain&gt;; object-src &#39;self&#39; http(s)://&lt;your-domain&gt;&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1"># https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP</span>
</pre></div>
</div>
<p>After you created the file, edit the <code class="docutils literal notranslate"><span class="pre">docker-compose.yml</span></code> and mount it to the <code class="docutils literal notranslate"><span class="pre">nginx</span></code> with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>volumes:
-<span class="w"> </span>./example_config/nginx/security.conf:/etc/nginx/conf.d/security.conf
</pre></div>
</div>
<p><strong>IMPORTANT</strong> Mount the exact name &amp; not the directory, because otherwise you would overwrite the whole directory and the other files would be gone inside the container.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/Logo_Intel_MQ.svg" alt="Logo"/>
    
  </a>
</p>



<p class="blurb">IntelMQ is a solution for IT security teams for collecting and processing security feeds using a message queuing protocol.</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=certtools&repo=intelmq&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="organization.html">IntelMQ Organizational Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Getting support</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html#development">Development</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="hardware-requirements.html">Hardware Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="upgrade.html">Upgrade instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration-management.html">Configuration and Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="bots.html">Bots inventory</a></li>
<li class="toctree-l1"><a class="reference internal" href="intelmqctl.html">intelmqctl documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="feeds.html">Data Feeds</a></li>
<li class="toctree-l1"><a class="reference internal" href="intelmq-api.html">IntelMQ API</a></li>
<li class="toctree-l1"><a class="reference internal" href="intelmq-manager.html">IntelMQ Manager</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Frequently asked questions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="universe.html">IntelMQ Universe</a></li>
<li class="toctree-l1"><a class="reference internal" href="ELK-Stack.html">ELK Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="MISP-Integrations.html">MISP integrations in IntelMQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="n6-integrations.html">IntelMQ - n6 Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="CIFv3-Integrations.html">CIFv3 integrations in IntelMQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="eventdb.html">EventDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="abuse-contacts.html">Abuse-contact look-ups</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev/guide.html">Developers Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/library.html">Running IntelMQ as Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/data-format.html">Data Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/harmonization-fields.html">Harmonization field names</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/release-procedure.html">Release procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/feeds-wishlist.html">Feeds wishlist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/modules.html">Code documentation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="intelmq-manager.html" title="previous chapter">IntelMQ Manager</a></li>
      <li>Next: <a href="universe.html" title="next chapter">IntelMQ Universe</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, IntelMQ community.
      
      |
      <a href="../_sources/user/FAQ.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>