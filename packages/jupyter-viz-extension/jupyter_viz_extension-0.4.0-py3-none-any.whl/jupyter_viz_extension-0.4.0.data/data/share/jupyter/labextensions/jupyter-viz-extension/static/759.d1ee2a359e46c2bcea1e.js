"use strict";(self.webpackChunkjupyter_viz_extension=self.webpackChunkjupyter_viz_extension||[]).push([[759],{759:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_});var a=n(303),l=n(832),i=n(271),c=n.n(i),r=n(628),o=n.n(r),s=n(344),u=n(139);async function m(e,t={}){const n=u.ServerConnection.makeSettings(),a=s.URLExt.join(n.baseUrl,"jupyter-viz-extension",e);let l;try{l=await u.ServerConnection.makeRequest(a,t,n)}catch(e){throw new u.ServerConnection.NetworkError(e)}let i=await l.text();if(i.length>0)try{i=JSON.parse(i)}catch(e){console.log("Not a JSON response body.",l)}if(!l.ok)throw new u.ServerConnection.ResponseError(l,i.message||i);return i}function d(e,t={}){const[n,a]=(0,i.useState)(null),l=()=>{m(e,t).then((e=>a(e))).catch((e=>console.error(e)))};return(0,i.useEffect)(l,[e,t]),[n,l]}function p(e,t){const n=document.createElement("label");return n.htmlFor=e,n.textContent=t,n}function h(e,t){const n=document.createElement("select");n.id=e;for(const e of t){const t=document.createElement("option");t.value=e,t.textContent=e,n.appendChild(t)}return n}function E(e,t,n,a=[]){const l=document.createElement("input");l.type=t,l.id=e,l.value=n,l.classList.add("form-input");for(const[e,t]of a)l.setAttribute(e,t);return l}class v extends l.Widget{constructor(){super(),this.fetchUserData=async()=>{const e=await m("user");for(const t of e.accounts){const e=document.createElement("option");e.value=t,e.textContent=t,this._accountElement.appendChild(e)}for(const t of e.partitions){const e=document.createElement("option");e.value=t,e.textContent=t,this._partitionElement.appendChild(e)}};const e=document.createElement("div");e.appendChild(p("name","Name: ")),e.appendChild(this._nameElement=E("name","text","ParaView Server")),this.node.appendChild(e);const t=document.createElement("div");t.appendChild(p("account","Account: ")),t.appendChild(this._accountElement=h("account",[])),this.node.appendChild(t);const n=document.createElement("div");n.appendChild(p("partition","Partition: ")),n.appendChild(this._partitionElement=h("partition",[])),this.node.appendChild(n);const a=document.createElement("div");a.appendChild(p("nodes","Nodes: ")),a.appendChild(this._nodesElement=E("nodes","number","4",[["min","1"],["max","32"],["step","1"]])),this.node.appendChild(a);const l=document.createElement("div");l.appendChild(p("time","Time: ")),l.appendChild(this._timeElement=E("time","text","02:00:00")),this.node.appendChild(l),this.fetchUserData()}getValue(){return{name:this._nameElement.value,account:this._accountElement.value,partition:this._partitionElement.value,nodes:Number(this._nodesElement.value),timeLimit:this._timeElement.value}}}class g extends l.Widget{constructor(e,t){super(),this.fetchUserData=async()=>{const e=await m("user");this._dataDirElement.value=e.home};const n=document.createElement("div");n.appendChild(p("name","Name: ")),n.appendChild(this._nameElement=E("name","text",`${e} Instance ${t+1}`)),this.node.appendChild(n);const a=document.createElement("div");a.appendChild(p("dataDir","Data Directory: ")),a.appendChild(this._dataDirElement=E("dataDir","text","")),this.node.appendChild(a),this.fetchUserData()}getValue(){return{name:this._nameElement.value,dataDirectory:this._dataDirElement.value}}}function f(e){return i.createElement("div",null,i.createElement("span",{style:{fontWeight:"bold"}},e.label,": "),i.createElement("span",null,e.value))}const C=(0,i.createContext)([]);function b({index:e}){const{name:t,account:n,nodes:a,partition:l,state:r,timeLimit:s,timeUsed:u}=(0,i.useContext)(C)[e],m=c().createElement(c().Fragment,null,c().createElement("b",null,t),c().createElement(f,{label:"Nodes",value:a.toString()}),c().createElement(f,{label:"Status",value:r}),c().createElement(f,{label:"Time",value:`${u} / ${s}`}));return c().createElement(c().Fragment,null,c().createElement(o(),{trigger:m},c().createElement(f,{label:"Project",value:n}),c().createElement(f,{label:"Partition",value:l}),c().createElement(f,{label:"Nodes",value:a.toString()})))}function w(){const[e,t]=d("paraview");return(0,i.useEffect)((()=>{const e=setInterval(t,3e4);return()=>clearInterval(e)}),[]),c().createElement(c().Fragment,null,c().createElement("h3",null,"Running ParaView backends:",c().createElement("button",{className:"launch-button",onClick:async function(){const e=await(0,a.showDialog)({title:"Launch a new ParaView instance",body:new v});console.log(e.value);const t=await m("paraview",{method:"POST",body:JSON.stringify(e.value)});await(0,a.showErrorMessage)(0===t.returnCode?"Success":"Error",t.message)}},"Launch")),c().createElement("div",{id:"paraview-instances",className:"instance-list"},c().createElement(C.Provider,{value:null!=e?e:[]},null==e?void 0:e.map(((e,t)=>c().createElement(b,{index:t}))))))}const x=(0,i.createContext)([]);function y({appName:e,appIndex:t,instanceIndex:n}){const{base_url:l,dataDirectory:r,log:u,name:d,port:p}=(0,i.useContext)(x)[t].instances[n],[h,E]=(0,i.useState)(null),v=c().createElement(c().Fragment,null,c().createElement("b",null,d)),g=h?c().createElement("div",{style:{marginTop:"10px"}},"Connected to ParaView Server ",c().createElement("span",{style:{fontWeight:"bold"}},h[0])," on ",c().createElement("span",{style:{fontWeight:"bold"}},h[1],":11111"),c().createElement("button",{className:"disconnect-button",onClick:async function(){await m(s.URLExt.join("trame","disconnect"),{method:"POST",body:JSON.stringify({appName:e,instanceName:d})}),E(null)}},"Disconnect")):c().createElement("button",{className:"connect-button",onClick:async function(){const t=await m("paraview"),n=await a.InputDialog.getItem({title:"Select ParaView Server to connect to",items:t.map((e=>e.name)),current:0,editable:!1});if(!n.value||0===n.value.length)return;console.log(`Connecting instance '${d}' to Server '${n.value}'`);const l=await m(s.URLExt.join("trame","connect"),{method:"POST",body:JSON.stringify({appName:e,instanceName:d,serverName:n.value})});E([n.value,l.url])}},"Connect");return c().createElement("li",null,c().createElement("div",{style:{flexGrow:1}},c().createElement(o(),{trigger:v},c().createElement(f,{label:"Data Directory",value:`${r}`}),c().createElement(f,{label:"Port",value:`${p}`}),c().createElement(f,{label:"Base URL",value:`${l}`}),c().createElement(f,{label:"Log File",value:u}),g)),c().createElement("button",{className:"open-button",onClick:function(){window.open(l,"_blank","noreferrer")}},"Open"))}function N({index:e}){const{displayName:t,name:n,path:l,instances:r}=(0,i.useContext)(x)[e],s=c().createElement("div",null,c().createElement("b",null," ",t," "),c().createElement("br",null),"Running Instances: ",r.length);return c().createElement(c().Fragment,null,c().createElement(o(),{trigger:s},c().createElement(f,{label:"Path",value:l}),c().createElement("div",{style:{height:"40px",margin:"10px 0 0 0"}},c().createElement("button",{className:"launch-button",onClick:async function(){const e=await(0,a.showDialog)({title:"Launch a new ParaView instance",body:new g(t,r.length)});console.log("Launching trame app:",e.value);const l=await m("trame",{method:"POST",body:JSON.stringify({appName:n,...e.value})});await(0,a.showErrorMessage)("Success",`Launched new trame instance on port ${l.port}`)}},"Launch")),c().createElement("div",{className:"instance-list"},r.map(((t,a)=>c().createElement(y,{appName:n,appIndex:e,instanceIndex:a}))))))}function S(){const[e,t]=d("trame");return(0,i.useEffect)((()=>{const e=setInterval(t,3e4);return()=>clearInterval(e)}),[]),c().createElement(c().Fragment,null,c().createElement("h3",null,"trame Apps:"),c().createElement("div",{id:"trame-instances",className:"instance-list"},c().createElement(x.Provider,{value:null!=e?e:[]},null==e?void 0:e.map(((e,t)=>c().createElement(N,{index:t}))))))}const _={id:"juviz-extension",autoStart:!0,activate:e=>{const t=new l.SplitPanel;t.orientation="vertical",t.id="juviz-sidepanel",t.title.iconClass="jp-ExtensionIcon jp-SideBar-tabIcon",t.title.caption="JuViz";const n=a.ReactWidget.create(c().createElement(w,null));n.addClass("juviz-sidepanel-segment"),t.addWidget(n);const i=a.ReactWidget.create(c().createElement(S,null));i.addClass("juviz-sidepanel-segment"),t.addWidget(i),e.shell.add(t,"left")}}}}]);