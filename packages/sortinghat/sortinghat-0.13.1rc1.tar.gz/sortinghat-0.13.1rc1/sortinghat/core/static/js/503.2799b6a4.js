"use strict";(self["webpackChunksortinghat_ui"]=self["webpackChunksortinghat_ui"]||[]).push([[503],{3503:(t,e,r)=>{r.r(e),r.d(e,{default:()=>ut});var s=r(9953),n=function(){var t=this,e=t._self._c;return e(s.Z,[e("tasks-table",{attrs:{"fetch-backends":t.fetchBackends,"fetch-tasks":t.fetchTasks,"create-task":t.createTask,"delete-task":t.deleteTask,"edit-task":t.editTask}})],1)},i=[],a=r(1907),o=r(5617),c=r(5246),l=r(680),u=r(457),d=r(5129),p=r(6035),h=r(2327),f=r(5830),m=r(4284),v=r(2269),k=r(5265),g=r(7768),Z=r(604),_=(r(8309),function(){var t=this,e=t._self._c;return e(p.Z,{staticClass:"section jobs mt-6 pa-0"},[e("header",{staticClass:"header"},[e("h1",{staticClass:"title"},[t._v("Import identities")]),e(k.Z,{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(r){var s=r.on;return[e(d.Z,t._g({attrs:{color:"primary",depressed:"",small:""}},s),[t._v(" Select source "),e(h.Z,{attrs:{color:"white",small:"",right:""}},[t._v("mdi-chevron-down")])],1)]}}])},[t.importers?e(f.Z,{attrs:{dense:""}},t._l(t.importers,(function(r,s){return e(m.Z,{key:s,on:{click:function(e){return t.openModal(r)}}},[e(v.V9,[t._v(" "+t._s(r.name)+" ")])],1)})),1):t._e()],1)],1),t.error?e(u.Z,{attrs:{text:"",type:"error"}},[t._v(" "+t._s(t.error)+" ")]):t._e(),t.isLoading?e(g.Z,{attrs:{indeterminate:"",color:"primary"}}):t._e(),e(Z.Z,{scopedSlots:t._u([{key:"default",fn:function(){return[t.tasks.length>0?e("thead",[e("tr",[e("th",{staticClass:"text-left"},[t._v("Source")]),e("th",{staticClass:"text-left"},[t._v("Last run")]),e("th",{staticClass:"text-left"},[t._v("Next run")]),e("th",{staticClass:"text-right"},[t._v("Executions")]),e("th",{staticClass:"text-right"},[t._v("Failures")]),e("th")])]):e("div",{staticClass:"ma-9"},[e("h3",{staticClass:"text-h6"},[t._v("No scheduled tasks")]),e("p",{staticClass:"text-body-2"},[t._v(" You can sync identities from different data sources automatically and periodically. ")])]),e("tbody",t._l(t.tasks,(function(r){return e("tr",{key:r.id},[e("td",[e("span",{staticClass:"font-weight-medium"},[t._v(" "+t._s(r.args.backend_name)+" ")])]),e("td",[r.lastExecution?e(h.Z,{staticClass:"mb-1 mr-1",attrs:{color:r.failed?"failed":"finished","aria-label":r.failed?"failed":"finished","aria-hidden":"false",small:""}},[t._v(" "+t._s(r.failed?"mdi-alert-circle":"mdi-check-circle")+" ")]):t._e(),t._v(" "+t._s(t.formatDate(r.lastExecution))+" ")],1),e("td",[t._v(t._s(t.formatDate(r.scheduledDatetime)))]),e("td",{staticClass:"text-right"},[t._v(t._s(r.executions))]),e("td",{staticClass:"text-right"},[t._v(t._s(r.failures))]),e("td",{staticClass:"text-right pr-8"},[e(d.Z,{staticClass:"mr-2",attrs:{color:"primary",text:"",small:"",outlined:""},on:{click:function(e){return t.openModal(r.args.backend_name,r)}}},[e(h.Z,{attrs:{small:""}},[t._v("mdi-pencil")]),e("span",{staticClass:"d-sr-only"},[t._v("Edit task")])],1),e(d.Z,{attrs:{color:"primary",text:"",small:"",outlined:""},on:{click:function(e){return t.deleteItem(r.id)}}},[e(h.Z,{attrs:{small:""}},[t._v("mdi-delete")]),e("span",{staticClass:"d-sr-only"},[t._v("Delete task")])],1)],1)])})),0)]},proxy:!0}])}),t.modal.isOpen?e("importer-modal",{attrs:{"is-open":t.modal.isOpen,"create-task":t.createTask,"edit-task":t.editTask,task:t.modal.task,importer:t.modal.importer},on:{"update:open":function(e){t.modal.isOpen=e},"update:tasks":function(e){return t.getTasks()}}}):t._e()],1)}),b=[],y=(r(3710),r(9826),r(1539),r(3385)),x=r(5223),C=r(4437),w=r(5144),S=r(905),$=r(6080),I=r(3078),T=r(1012),B=r(1804),E=r(4609),O=r(8914),D=r(4791),F=r(1734),L=r(3276),G=r(911),q=r(1050),A=r(4987),M=r(2653),P=["title"],j=(0,A.Z)(E.Z,O.Z,F.Z,(0,D.d)("radioGroup"),L.Z);const N=j.extend().extend({name:"v-radio",inheritAttrs:!1,props:{disabled:Boolean,id:String,label:String,name:String,offIcon:{type:String,default:"$radioOff"},onIcon:{type:String,default:"$radioOn"},readonly:Boolean,value:{default:null}},data:function(){return{isFocused:!1}},computed:{classes:function(){return(0,$.Z)((0,$.Z)({"v-radio--is-disabled":this.isDisabled,"v-radio--is-focused":this.isFocused},this.themeClasses),this.groupClasses)},computedColor:function(){if(!this.isDisabled)return G.Z.options.computed.computedColor.call(this)},computedIcon:function(){return this.isActive?this.onIcon:this.offIcon},computedId:function(){return B.Z.options.computed.computedId.call(this)},hasLabel:B.Z.options.computed.hasLabel,hasState:function(){return(this.radioGroup||{}).hasState},isDisabled:function(){return this.disabled||!!this.radioGroup&&this.radioGroup.isDisabled},isReadonly:function(){return this.readonly||!!this.radioGroup&&this.radioGroup.isReadonly},computedName:function(){return this.name||!this.radioGroup?this.name:this.radioGroup.name||"radio-".concat(this.radioGroup._uid)},rippleState:function(){return G.Z.options.computed.rippleState.call(this)},validationState:function(){return(this.radioGroup||{}).validationState||this.computedColor}},methods:{genInput:function(t){return G.Z.options.methods.genInput.call(this,"radio",t)},genLabel:function(){return this.hasLabel?this.$createElement(I.Z,{on:{click:G.X},attrs:{for:this.computedId},props:{color:this.validationState,focused:this.hasState}},(0,q.z9)(this,"label")||this.label):null},genRadio:function(){var t=this.attrs$,e=(t.title,(0,S.Z)(t,P));return this.$createElement("div",{staticClass:"v-input--selection-controls__input"},[this.$createElement(T.Z,this.setTextColor(this.validationState,{props:{dense:this.radioGroup&&this.radioGroup.dense}}),this.computedIcon),this.genInput((0,$.Z)({name:this.computedName,value:this.value},e)),this.genRipple(this.setTextColor(this.rippleState))])},onFocus:function(t){this.isFocused=!0,this.$emit("focus",t)},onBlur:function(t){this.isFocused=!1,this.$emit("blur",t)},onChange:function(){this.isDisabled||this.isReadonly||this.isActive||this.toggle()},onKeydown:function(){}},render:function(t){var e={staticClass:"v-radio",class:this.classes,on:(0,M.bp)({click:this.onChange},this.listeners$),attrs:{title:this.attrs$.title}};return t("div",e,[this.genRadio(),this.genLabel()])}});r(9653),r(1629);var R=r(5064),W=(0,A.Z)(R.y,B.Z);const J=W.extend({name:"v-radio-group",provide:function(){return{radioGroup:this}},props:{column:{type:Boolean,default:!0},height:{type:[Number,String],default:"auto"},name:String,row:Boolean,value:null},computed:{classes:function(){return(0,$.Z)((0,$.Z)({},B.Z.options.computed.classes.call(this)),{},{"v-input--selection-controls v-input--radio-group":!0,"v-input--radio-group--column":this.column&&!this.row,"v-input--radio-group--row":this.row})}},methods:{genDefaultSlot:function(){return this.$createElement("div",{staticClass:"v-input--radio-group__input",attrs:{id:this.id,role:"radiogroup","aria-labelledby":this.computedId}},B.Z.options.methods.genDefaultSlot.call(this))},genInputSlot:function(){var t=B.Z.options.methods.genInputSlot.call(this);return delete t.data.on.click,t},genLabel:function(){var t=B.Z.options.methods.genLabel.call(this);return t?(t.data.attrs.id=this.computedId,delete t.data.attrs["for"],t.tag="legend",t):null},onClick:R.y.options.methods.onClick},render:function(t){var e=B.Z.options.render.call(this,t);return this._b(e.data,"div",this.attrs$),e}});var K=r(5294),z=r(5234),U=r(3606),V=function(){var t=this,e=t._self._c;return e(w.Z,{attrs:{"max-width":"450"},on:{"click:outside":function(e){return t.$emit("update:open")}},model:{value:t.isOpen,callback:function(e){t.isOpen=e},expression:"isOpen"}},[e(y.Z,{staticClass:"section"},[e(x.EB,{staticClass:"header title"},[t._v(" Import identities from "+t._s(t.importer.name)+" ")]),e(x.ZB,{staticClass:"mt-3"},[e("h3",{staticClass:"subheader mb-2"},[t._v("Settings")]),t._l(t.form.fields,(function(r,s){return e(K.Z,{key:s,staticClass:"pa-3"},[e(U.Z,{attrs:{label:s,dense:"","hide-details":"",outlined:""},model:{value:t.form.fields[s],callback:function(e){t.$set(t.form.fields,s,e)},expression:"form.fields[field]"}})],1)})),e(K.Z,[e(C.Z,{attrs:{cols:"6"}},[e(J,{staticClass:"mt-0",attrs:{dense:""},scopedSlots:t._u([{key:"label",fn:function(){return[e("h3",{staticClass:"subheader"},[t._v("Run script")])]},proxy:!0}]),model:{value:t.form.interval,callback:function(e){t.$set(t.form,"interval",e)},expression:"form.interval"}},[e(N,{attrs:{value:0,label:"Once"}}),e(N,{attrs:{value:10080,label:"Every week"}}),e(N,{attrs:{value:43800,label:"Every month"}}),e(N,{attrs:{value:"custom",label:"Custom"}})],1),e(U.Z,{staticClass:"ml-8",attrs:{label:"Every",type:"number",suffix:"minutes",dense:"","hide-details":"",outlined:""},model:{value:t.form.customInterval,callback:function(e){t.$set(t.form,"customInterval",e)},expression:"form.customInterval"}})],1)],1),t.error?e(u.Z,{staticClass:"ma-5",attrs:{text:"",type:"error"}},[t._v(" "+t._s(t.error)+" ")]):t._e()],2),e(x.h7,[e(z.Z),e(d.Z,{attrs:{color:"primary",text:""},on:{click:t.onClose}},[t._v(" Cancel ")]),e(d.Z,{attrs:{color:"primary",disabled:!t.form.fields.url,depressed:""},on:{click:t.onSave}},[t._v(" Save ")])],1)],1)],1)},X=[],Y=r(4503);r(8862),r(5827);const H={name:"ImporterModal",props:{importer:{type:Object,required:!0},task:{type:Object,required:!0},createTask:{type:Function,required:!0},editTask:{type:Function,required:!0},isOpen:{type:Boolean,default:!1}},data:function(){return{form:{fields:{},interval:this.task.interval||0,customInterval:""},error:null}},methods:{onSave:function(){this.task.id?this.updateTask():this.addTask()},onClose:function(){this.$emit("update:open",!1)},addTask:function(){var t=this;return(0,o.Z)((0,a.Z)().mark((function e(){var r,s,n;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,r="custom"===t.form.interval?t.form.customInterval:t.form.interval,s=JSON.stringify((0,$.Z)({backend_name:t.importer.name},t.form.fields)),e.next=5,t.createTask("import_identities",r,s);case 5:n=e.sent,n&&!n.errors&&(t.$emit("update:open",!1),t.$emit("update:tasks")),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),t.error=t.$getErrorMessage(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()},updateTask:function(){var t=this;return(0,o.Z)((0,a.Z)().mark((function e(){var r,s,n,i;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,r="custom"===t.form.interval?t.form.customInterval:t.form.interval,s=JSON.stringify((0,$.Z)({backend_name:t.importer.name},t.form.fields)),n={interval:r,params:s},e.next=6,t.editTask(t.task.id,n);case 6:i=e.sent,i&&!i.errors&&(t.$emit("update:open",!1),t.$emit("update:tasks")),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),t.error=t.$getErrorMessage(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()},buildForm:function(){var t=this,e=[0,10080,43800],r=this.task.args||{},s=this.importer.args.reduce((function(t,e){return(0,$.Z)((0,$.Z)({},t),{},(0,Y.Z)({},e,r[e]))}),{});this.form.fields=s,this.task.interval&&!e.find((function(e){return e===t.task.interval}))&&(this.form.customInterval=this.task.interval,this.form.interval="custom")}},mounted:function(){this.buildForm()}},Q=H;var tt=r(1001),et=(0,tt.Z)(Q,V,X,!1,null,null,null);const rt=et.exports,st={name:"TasksTable",components:{ImporterModal:rt},props:{fetchBackends:{type:Function,required:!0},fetchTasks:{type:Function,required:!0},createTask:{type:Function,required:!0},deleteTask:{type:Function,required:!0},editTask:{type:Function,required:!0}},data:function(){return{importers:[],tasks:[],error:null,isLoading:!1,modal:{isOpen:!1,task:{},importer:{}}}},methods:{formatDate:function(t){return t?new Date(t).toLocaleString():"-"},openModal:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"string"===typeof t&&(t=this.importers.find((function(e){return e.name===t}))),Object.assign(this.modal,{isOpen:!0,importer:t,task:e})},getBackends:function(){var t=this;return(0,o.Z)((0,a.Z)().mark((function e(){var r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.fetchBackends();case 3:r=e.sent,t.importers=r.data.identitiesImportersTypes,e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),t.error=t.$getErrorMessage(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},getTasks:function(){var t=this;return(0,o.Z)((0,a.Z)().mark((function e(){var r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.isLoading=!0,e.next=4,t.fetchTasks();case 4:r=e.sent,t.tasks=r.data.scheduledTasks.entities,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.error=t.$getErrorMessage(e.t0);case 11:return e.prev=11,t.isLoading=!1,e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})))()},deleteItem:function(t){var e=this;return(0,o.Z)((0,a.Z)().mark((function r(){var s;return(0,a.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.deleteTask(t);case 3:s=r.sent,s.data.deleteScheduledTask&&e.getTasks(),r.next=10;break;case 7:r.prev=7,r.t0=r["catch"](0),e.error=e.$getErrorMessage(r.t0);case 10:case"end":return r.stop()}}),r,null,[[0,7]])})))()}},mounted:function(){var t=this;return(0,o.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.getTasks(),e.next=3,t.getBackends();case 3:case"end":return e.stop()}}),e)})))()}},nt=st;var it=(0,tt.Z)(nt,_,b,!1,null,"46e97834",null);const at=it.exports,ot={name:"ImportIdentities",components:{TasksTable:at},methods:{fetchBackends:function(){var t=this;return(0,o.Z)((0,a.Z)().mark((function e(){var r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,c.S9)(t.$apollo);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})))()},fetchTasks:function(){var t=this;return(0,o.Z)((0,a.Z)().mark((function e(){var r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,c.qw)(t.$apollo);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})))()},createTask:function(t,e,r){var s=this;return(0,o.Z)((0,a.Z)().mark((function n(){var i;return(0,a.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,l.nf)(s.$apollo,t,e,r);case 2:return i=n.sent,n.abrupt("return",i);case 4:case"end":return n.stop()}}),n)})))()},deleteTask:function(t){var e=this;return(0,o.Z)((0,a.Z)().mark((function r(){var s;return(0,a.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,(0,l.BD)(e.$apollo,t);case 2:return s=r.sent,r.abrupt("return",s);case 4:case"end":return r.stop()}}),r)})))()},editTask:function(t,e){var r=this;return(0,o.Z)((0,a.Z)().mark((function s(){var n;return(0,a.Z)().wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,(0,l.U_)(r.$apollo,t,e);case 2:return n=s.sent,s.abrupt("return",n);case 4:case"end":return s.stop()}}),s)})))()}}},ct=ot;var lt=(0,tt.Z)(ct,n,i,!1,null,"653751da",null);const ut=lt.exports},457:(t,e,r)=>{r.d(e,{Z:()=>f});var s=r(6080),n=r(4503),i=(r(6699),r(2925)),a=r(1903),o=r(1012),c=r(6470),l=r(3276),u=r(144);const d=u.ZP.extend({name:"transitionable",props:{mode:String,origin:String,transition:String}});var p=r(4987),h=r(6596);const f=(0,p.Z)(i.Z,c.Z,d).extend({name:"v-alert",props:{border:{type:String,validator:function(t){return["top","right","bottom","left"].includes(t)}},closeLabel:{type:String,default:"$vuetify.close"},coloredBorder:Boolean,dense:Boolean,dismissible:Boolean,closeIcon:{type:String,default:"$cancel"},icon:{default:"",type:[Boolean,String],validator:function(t){return"string"===typeof t||!1===t}},outlined:Boolean,prominent:Boolean,text:Boolean,type:{type:String,validator:function(t){return["info","error","success","warning"].includes(t)}},value:{type:Boolean,default:!0}},computed:{__cachedBorder:function(){if(!this.border)return null;var t={staticClass:"v-alert__border",class:(0,n.Z)({},"v-alert__border--".concat(this.border),!0)};return this.coloredBorder&&(t=this.setBackgroundColor(this.computedColor,t),t["class"]["v-alert__border--has-color"]=!0),this.$createElement("div",t)},__cachedDismissible:function(){var t=this;if(!this.dismissible)return null;var e=this.iconColor;return this.$createElement(a.Z,{staticClass:"v-alert__dismissible",props:{color:e,icon:!0,small:!0},attrs:{"aria-label":this.$vuetify.lang.t(this.closeLabel)},on:{click:function(){return t.isActive=!1}}},[this.$createElement(o.Z,{props:{color:e}},this.closeIcon)])},__cachedIcon:function(){return this.computedIcon?this.$createElement(o.Z,{staticClass:"v-alert__icon",props:{color:this.iconColor}},this.computedIcon):null},classes:function(){var t=(0,s.Z)((0,s.Z)({},i.Z.options.computed.classes.call(this)),{},{"v-alert--border":Boolean(this.border),"v-alert--dense":this.dense,"v-alert--outlined":this.outlined,"v-alert--prominent":this.prominent,"v-alert--text":this.text});return this.border&&(t["v-alert--border-".concat(this.border)]=!0),t},computedColor:function(){return this.color||this.type},computedIcon:function(){return!1!==this.icon&&("string"===typeof this.icon&&this.icon?this.icon:!!["error","info","success","warning"].includes(this.type)&&"$".concat(this.type))},hasColoredIcon:function(){return this.hasText||Boolean(this.border)&&this.coloredBorder},hasText:function(){return this.text||this.outlined},iconColor:function(){return this.hasColoredIcon?this.computedColor:void 0},isDark:function(){return!(!this.type||this.coloredBorder||this.outlined)||l.Z.options.computed.isDark.call(this)}},created:function(){this.$attrs.hasOwnProperty("outline")&&(0,h.fK)("outline","outlined",this)},methods:{genWrapper:function(){var t=[this.$slots.prepend||this.__cachedIcon,this.genContent(),this.__cachedBorder,this.$slots.append,this.$scopedSlots.close?this.$scopedSlots.close({toggle:this.toggle}):this.__cachedDismissible],e={staticClass:"v-alert__wrapper"};return this.$createElement("div",e,t)},genContent:function(){return this.$createElement("div",{staticClass:"v-alert__content"},this.$slots["default"])},genAlert:function(){var t={staticClass:"v-alert",attrs:{role:"alert"},on:this.listeners$,class:this.classes,style:this.styles,directives:[{name:"show",value:this.isActive}]};if(!this.coloredBorder){var e=this.hasText?this.setTextColor:this.setBackgroundColor;t=e(this.computedColor,t)}return this.$createElement("div",t,[this.genWrapper()])},toggle:function(){this.isActive=!this.isActive}},render:function(t){var e=this.genAlert();return this.transition?t("transition",{props:{name:this.transition,origin:this.origin,mode:this.mode}},[e]):e}})},1903:(t,e,r)=>{r.d(e,{Z:()=>n});var s=r(5129);const n=s.Z},6035:(t,e,r)=>{r.d(e,{Z:()=>a});r(7327),r(1539),r(7941),r(6755),r(2222),r(9894),r(4198),r(3210),r(9600);var s=r(144);function n(t){return s.ZP.extend({name:"v-".concat(t),functional:!0,props:{id:String,tag:{type:String,default:"div"}},render:function(e,r){var s=r.props,n=r.data,i=r.children;n.staticClass="".concat(t," ").concat(n.staticClass||"").trim();var a=n.attrs;if(a){n.attrs={};var o=Object.keys(a).filter((function(t){if("slot"===t)return!1;var e=a[t];return t.startsWith("data-")?(n.attrs[t]=e,!1):e||"string"===typeof e}));o.length&&(n.staticClass+=" ".concat(o.join(" ")))}return s.id&&(n.domProps=n.domProps||{},n.domProps.id=s.id),e(s.tag,n,i)}})}var i=r(2653);const a=n("container").extend({name:"v-container",functional:!0,props:{id:String,tag:{type:String,default:"div"},fluid:{type:Boolean,default:!1}},render:function(t,e){var r,s=e.props,n=e.data,a=e.children,o=n.attrs;return o&&(n.attrs={},r=Object.keys(o).filter((function(t){if("slot"===t)return!1;var e=o[t];return t.startsWith("data-")?(n.attrs[t]=e,!1):e||"string"===typeof e}))),s.id&&(n.domProps=n.domProps||{},n.domProps.id=s.id),t(s.tag,(0,i.ZP)(n,{staticClass:"container",class:Array({"container--fluid":s.fluid}).concat(r||[])}),a)}})}}]);