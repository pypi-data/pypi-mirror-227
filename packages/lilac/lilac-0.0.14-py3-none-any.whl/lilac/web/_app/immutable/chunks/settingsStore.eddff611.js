import{ad as E,P as T,am as b,ai as C}from"./index.d15f259d.js";import{w as x}from"./index.984ba69d.js";const d={};function m(t){return t==="local"?localStorage:sessionStorage}function N(t,c,e){const r=(e==null?void 0:e.serializer)??JSON,a=(e==null?void 0:e.storage)??"local",s=typeof window<"u"&&typeof document<"u";function S(i,u){s&&m(a).setItem(i,r.stringify(u))}if(!d[t]){const i=x(c,n=>{const o=s?m(a).getItem(t):null;if(o&&n(r.parse(o)),s){const w=g=>{g.key===t&&n(g.newValue?r.parse(g.newValue):null)};return window.addEventListener("storage",w),()=>window.removeEventListener("storage",w)}}),{subscribe:u,set:l}=i;d[t]={set(n){S(t,n),l(n)},update(n){const o=n(E(i));S(t,o),l(o)},subscribe:u}}return d[t]}const f="SETTINGS_CONTEXT",O="settingsStore";function I(){const t={},{subscribe:c,set:e,update:r}=N(O,t,{storage:"session"});return{subscribe:c,set:e,update:r,reset(){e(JSON.parse(JSON.stringify(t)))},setEmbedding(a){r(s=>(s.embedding=a,s))}}}function h(t){T(f,t)}function J(){if(!b(f))throw new Error("SettingsContext not found");return C(f)}export{I as c,J as g,h as s};
